!function(a){"use strict";function b(){console.log.apply(console,arguments)}function d(a,b){var f;this.list=a,this.options=b=b||{};for(f in c)c.hasOwnProperty(f)&&("boolean"==typeof c[f]?this.options[f]=f in b?b[f]:c[f]:this.options[f]=b[f]||c[f])}function e(a,b,c){var d,e,f,g;return b?(f=b.indexOf("."),f!==-1?(d=b.slice(0,f),e=b.slice(f+1)):d=b,g=a[d],null!==g&&void 0!==g&&(e||"string"!=typeof g&&"number"!=typeof g||c.push(g))):c.push(a),c}function f(a){return"[object Array]"===Object.prototype.toString.call(a)}function g(a,b){b=b||{},this.options=b,this.options.location=b.location||g.defaultOptions.location,this.options.distance="distance"in b?b.distance:g.defaultOptions.distance,this.options.threshold="threshold"in b?b.threshold:g.defaultOptions.threshold,this.options.maxPatternLength=b.maxPatternLength||g.defaultOptions.maxPatternLength,this.pattern=b.caseSensitive?a:a.toLowerCase(),this.patternLen=a.length,this.patternLen<=this.options.maxPatternLength&&(this.matchmask=1<<this.patternLen-1,this.patternAlphabet=this._calculatePatternAlphabet())}var c={id:null,caseSensitive:!1,include:[],score:100,shouldSort:!0,searchFn:g,sortFn:function(a,b){return a.score-b.score},getFn:e,keys:[],verbose:!1,tokenize:!1,matchAllTokens:!1,tokenSeparator:/ +/g,minMatchCharLength:1,findAllMatches:!1};d.VERSION="2.6.0",d.prototype.set=function(a){return this.list=a,a},d.prototype.search=function(a){this.options.verbose&&b("\nSearch term:",a,"\n"),this.pattern=a,this.results=[],this.resultMap={},this._keyMap=null,this._prepareSearchers(),this._startSearch(),this._computeScore(),this._sort();var c=this._format();return c},d.prototype._prepareSearchers=function(){var a=this.options,b=this.pattern,c=a.searchFn,d=b.split(a.tokenSeparator),e=0,f=d.length;if(this.options.tokenize)for(this.tokenSearchers=[];e<f;e++)this.tokenSearchers.push(new c(d[e],a));this.fullSeacher=new c(b,a)},d.prototype._startSearch=function(){var g,j,k,a=this.options,c=(a.getFn,this.list),d=c.length,e=this.options.keys,f=e.length,i=null;if("string"==typeof c[0])for(j=0;j<d;j++)this._analyze("",c[j],j,j);else for(this._keyMap={},j=0;j<d;j++)for(i=c[j],k=0;k<f;k++)g=e[k],this._keyMap[g]={weight:1},this._analyze(g,i[g],i,j)},d.prototype._analyze=function(a,c,d,e){var h,i,k,l,m,n,o,p,q,r,s,t,u,v,w,g=this.options,j=!1;if(void 0!==c&&null!==c){i=[];var x=0;if("string"==typeof c){if(g.verbose&&b("---------\nKey:",a),this.options.tokenize){for(h=c.split(g.tokenSeparator),v=0;v<this.tokenSearchers.length;v++){for(p=this.tokenSearchers[v],g.verbose&&b("Pattern:",p.pattern),q=[],t=!1,w=0;w<h.length;w++){r=h[w],s=p.search(r);var y={};s.isMatch?(y[r]=s.score,j=!0,t=!0,i.push(s.score)):(y[r]=1,this.options.matchAllTokens||i.push(1)),q.push(y)}t&&x++,g.verbose&&b("Token scores:",q)}for(l=i[0],n=i.length,v=1;v<n;v++)l+=i[v];l/=n,g.verbose&&b("Token score average:",l)}o=this.fullSeacher.search(c),g.verbose&&b("Full text score:",o.score),m=o.score,void 0!==l&&(m=(m+l)/2),g.verbose&&b("Score average:",m),u=!this.options.tokenize||!this.options.matchAllTokens||x>=this.tokenSearchers.length,g.verbose&&b("Check Matches",u),(j||o.isMatch)&&u&&(k=this.resultMap[e],k?k.output.push({key:a,score:m}):(this.resultMap[e]={item:d,output:[{key:a,score:m}]},this.results.push(this.resultMap[e])))}else if(f(c))for(v=0;v<c.length;v++)this._analyze(a,c[v],d,e)}},d.prototype._computeScore=function(){var a,c,e,f,g,h,i,k,l,d=this._keyMap,j=this.results;for(this.options.verbose&&b("\n\nComputing score:\n"),a=0;a<j.length;a++){for(e=0,f=j[a].output,g=f.length,k=1,c=0;c<g;c++)h=f[c].score,i=d?d[f[c].key].weight:1,l=h*i,1!==i?k=Math.min(k,l):(e+=l,f[c].nScore=l);1===k?j[a].score=e/g:j[a].score=k,this.options.verbose&&b(j[a])}},d.prototype._sort=function(){var a=this.options;a.shouldSort&&(a.verbose&&b("\n\nSorting...."),this.results.sort(a.sortFn))},d.prototype._format=function(){var e,f,g,i,j,a=this.options,c=a.getFn,d=[],h=this.results,k=a.include;for(a.verbose&&b("\n\nOutput:\n\n",h),i=a.id?function(b){h[b].item=c(h[b].item,a.id,[])[0]}:function(){},j=function(a){var c,d,e,f,g,b=h[a];if(k.length>0){if(c={item:b.item},k.indexOf("matches")!==-1)for(e=b.output,c.matches=[],d=0;d<e.length;d++)f=e[d],g={indices:f.matchedIndices},f.key&&(g.key=f.key),c.matches.push(g);k.indexOf("score")!==-1&&(c.score=h[a].score)}else c=b.item;return c},f=0,g=h.length;f<g;f++)i(f),e=j(f),d.push(e);return d},g.defaultOptions={location:0,distance:100,threshold:.6,maxPatternLength:32},g.prototype._calculatePatternAlphabet=function(){var a={},b=0;for(b=0;b<this.patternLen;b++)a[this.pattern.charAt(b)]=0;for(b=0;b<this.patternLen;b++)a[this.pattern.charAt(b)]|=1<<this.pattern.length-b-1;return a},g.prototype._bitapScore=function(a,b){var c=a/this.patternLen,d=Math.abs(this.options.location-b);return this.options.distance?c+d/this.options.distance:d?1:c},g.prototype.search=function(a){var c,d,e,f,g,h,i,j,k,l,m,n,q,r,s,t,u,b=this.options,o=[],p=[];if(a=b.caseSensitive?a:a.toLowerCase(),this.pattern===a)return{isMatch:!0,score:0};if(this.patternLen>b.maxPatternLength)return s=a.match(new RegExp(this.pattern.replace(b.tokenSeparator,"|"))),t=!!s,{isMatch:t,score:t?.5:1};for(f=b.findAllMatches,g=b.location,e=a.length,h=b.threshold,i=a.indexOf(this.pattern,g),u=[],c=0;c<e;c++)u[c]=0;for(i!=-1&&(h=Math.min(this._bitapScore(0,i),h),i=a.lastIndexOf(this.pattern,g+this.patternLen),i!=-1&&(h=Math.min(this._bitapScore(0,i),h))),i=-1,r=1,l=this.patternLen+e,c=0;c<this.patternLen;c++){for(j=0,k=l;j<k;)this._bitapScore(c,g+k)<=h?j=k:l=k,k=Math.floor((l-j)/2+j);for(l=k,m=Math.max(1,g-k+1),n=f?e:Math.min(g+k,e)+this.patternLen,o=[],o[n+1]=(1<<c)-1,d=n;d>=m;d--)if(q=this.patternAlphabet[a.charAt(d-1)],q&&(u[d-1]=1),0===c?o[d]=(o[d+1]<<1|1)&q:o[d]=(o[d+1]<<1|1)&q|((p[d+1]|p[d])<<1|1)|p[d+1],o[d]&this.matchmask&&(r=this._bitapScore(c,d-1),r<=h)){if(h=r,i=d-1,!(i>g))break;m=Math.max(1,2*g-i)}if(this._bitapScore(c+1,g)>h)break;p=o}return{isMatch:i>=0,score:0===r?.001:r}},g.prototype._getMatchedIndices=function(a){for(var f,b=[],c=-1,d=-1,e=0,g=a.length;e<g;e++)f=a[e],f&&c===-1?c=e:f||c===-1||(d=e-1,d-c+1>=this.options.minMatchCharLength&&b.push([c,d]),c=-1);return a[e-1]&&e-1-c+1>=this.options.minMatchCharLength&&b.push([c,e-1]),b},"object"==typeof exports?module.exports=d:"function"==typeof define&&define.amd?define(function(){return d}):a.Fuse=d}(this);
